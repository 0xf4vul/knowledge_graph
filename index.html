<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script type="text/javascript" src="js/d3.min.js" ></script>
		<script type="text/javascript" src="js/strucMap.min.js" ></script>
		<link rel="stylesheet" href="css/strucMap.min.css" />
		
	</head>
	<body>
		<div id="topomap" style="margin: 100px auto;" ></div>
		<script type="text/javascript">

			var nodePX = 0;
			var nodePY = 0;

	        var options = {
	        	selector:"#topomap",
	            width: 1140,//实际展开图宽度
	            height: 840,//实际展开图高度
	            lineLength:100,
//	            textColor:"#000",
//	            textFontFamily:'',
	            nodesClick: function(t) {
					//if(t.index==0) t.fixed=1;//判断如果是第一级，移动后就将它固定
					t.fixed = 1;
					console.log(t);
					var nodeX = JSON.parse(JSON.stringify(t.x));
					var nodeY = JSON.parse(JSON.stringify(t.y));
					//xy都没有变，说明没有拖动
					if((nodeX == nodePX)&&(nodeY == nodePY)){
						console.info("跳页面啦~~~~~~");
					}
				},
				nodesDragstart:function(t) {
					nodePX = JSON.parse(JSON.stringify(t.x));
					nodePY = JSON.parse(JSON.stringify(t.y));
					//console.log("移动开始",JSON.parse(JSON.stringify(t.x)),JSON.parse(JSON.stringify(t.y)));
				}
				};
						
	            var nodesJson = [{"fixed":true,"id":2,"index":0,"prop":{"name":"双调设备","size":32},"x":560,"y":430},
												{"id":"22","index":1,"prop":{"name":"工作平台","size":25}},
												{"id":36,"index":2,"prop":{"name":"发电机设备","size":10}},
												{"id":37,"index":2,"prop":{"name":"水轮机设备","size":25}},
												{"id":58,"index":2,"prop":{"name":"GIS组合电器设备","size":12}},
												{"id":59,"index":2,"prop":{"name":"气体绝缘输电线路（GIL）","size":35}},
												{"id":61,"index":2,"prop":{"name":"电力变压器","size":10}},
												{"id":"23","index":1,"prop":{"name":"资源汇总","size":15}},
												{"id":38,"index":2,"prop":{"name":"电抗器","size":12}},
												{"id":54,"index":2,"prop":{"name":"避雷器","size":12}},
												{"id":63,"index":2,"prop":{"name":"电流互感器","size":15}},
												{"id":"24","index":1,"prop":{"name":"基本概念","size":25}},
												{"id":12,"index":2,"prop":{"name":"电压互感器","size":10}},
												{"id":"25","index":1,"prop":{"name":"学习方法","size":25}},
												{"id":39,"index":2,"prop":{"name":"电缆","size":12}},
												{"id":"26","index":1,"prop":{"name":"算法实现","size":25}},
												{"id":40,"index":2,"prop":{"name":"架空线路","size":35}},
												{"id":41,"index":2,"prop":{"name":"绝缘子","size":10}},
												{"id":43,"index":2,"prop":{"name":"继电保护设备","size":15}},
												{"id":"27","index":1,"prop":{"name":"数据预处理","size":10}},
												{"id":44,"index":2,"prop":{"name":"安自设备","size":18}},
												{"id":"28","index":1,"prop":{"name":"特征工程","size":15}},
												{"id":46,"index":2,"prop":{"name":"直流系统","size":10}},
												{"id":48,"index":2,"prop":{"name":"交流不间断电源系统","size":25}},
												{"id":"29","index":1,"prop":{"name":"问题建模","size":12}},
												{"id":49,"index":2,"prop":{"name":"绝缘材料","size":25}},
												{"id":"30","index":1,"prop":{"name":"模型选择","size":15}},
												{"id":51,"index":2,"prop":{"name":"阀门","size":10}},
												{"id":52,"index":2,"prop":{"name":"励磁设备","size":18}},
												{"id":"31","index":1,"prop":{"name":"模型评估","size":18}},
												{"id":53,"index":2,"prop":{"name":"在线监测设备","size":12}},

												 {"id":71,"index":2,"prop":{"name":"监控系统","size":18}},
												 {"id":72,"index":2,"prop":{"name":"继电器","size":19}},
												 {"id":73,"index":2,"prop":{"name":"调速器系统","size":13}},
												 {"id":74,"index":2,"prop":{"name":"信息通信设备","size":15}},
												 {"id":75,"index":2,"prop":{"name":"电能计量系统","size":16}},
												 {"id":76,"index":2,"prop":{"name":"照明系统","size":17}},
												 {"id":77,"index":2,"prop":{"name":"接地系统","size":18}},
												 {"id":78,"index":2,"prop":{"name":"交流高压开关设备","size":19}},
												 {"id":79,"index":2,"prop":{"name":"低压电器设备","size":15}},
												 {"id":80,"index":2,"prop":{"name":"压力容器","size":19}},
												 {"id":81,"index":2,"prop":{"name":"金属材料","size":22}},
												 {"id":82,"index":2,"prop":{"name":"水工金属结构","size":22}},
												 {"id":83,"index":2,"prop":{"name":"消防系统","size":32}},
												 {"id":84,"index":2,"prop":{"name":"起重设备","size":26}},
												 {"id":85,"index":2,"prop":{"name":"安健环设备设施","size":29}}
								];
				//source和target都是按照数组的顺序来的，下标
	           	var linksJson = [
								{"source":0,"target":1,},
								{"source":1,"target":2,},
								{"source":1,"target":3,},
								{"source":1,"target":4,},
								{"source":1,"target":5,},
								{"source":1,"target":6,},
								{"source":0,"target":7,},
								{"source":7,"target":8,},
								{"source":7,"target":9,},
								{"source":7,"target":10,},
								{"source":0,"target":11,},
								{"source":11,"target":12,},
								{"source":0,"target":13,},
								{"source":13,"target":14,},
								{"source":0,"target":15,},
								{"source":15,"target":16,},
								{"source":15,"target":17,},
								{"source":15,"target":18,},
								{"source":0,"target":19,},
								{"source":19,"target":20,},
								{"source":0,"target":21,},
								{"source":21,"target":22,},
								{"source":21,"target":23,},
								{"source":0,"target":24,},
								{"source":24,"target":25,},
								{"source":0,"target":26,},
								{"source":26,"target":27,},
								{"source":26,"target":28,},
								{"source":0,"target":29,},
								{"source":29,"target":30,},

								 {"source":11,"target":31,},
								 {"source":11,"target":32,},
								 {"source":13,"target":33,},
								 {"source":13,"target":34,},
								 {"source":13,"target":35,},
								 {"source":19,"target":36,},
								 {"source":19,"target":37,},
								 {"source":19,"target":38,},
								 {"source":19,"target":39,},
								 {"source":24,"target":40,},
								 {"source":24,"target":41,},
								 {"source":11,"target":42,},
								 {"source":11,"target":43,},
								 {"source":21,"target":44,},
								 {"source":21,"target":45,}
								];

				console.log("初始化打印",linksJson);
	            loadMap(options, nodesJson, linksJson);
		</script>
	</body>
</html>
